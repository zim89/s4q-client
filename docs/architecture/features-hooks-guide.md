# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ö—É–∫–∞–º –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π —Å–º. [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ñ—É–Ω–∫—Ü–∏–π](./feature-structure-guide.md)

## üîÑ –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö

### 1. Query —Ö—É–∫–∏ (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è query —Ö—É–∫–æ–≤

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - —Ö—É–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö:**

```typescript
// use-category-children.ts
'use client'

import { useQuery } from '@tanstack/react-query'
import { categoryApi, type CategoryChildrenParams } from '@/entities/category'

export const useCategoryChildren = (params?: CategoryChildrenParams) => {
  return useQuery({
    ...categoryApi.getCategoryChildrenQueryOptions(params),
  })
}

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å UI –ª–æ–≥–∏–∫–æ–π
export const CategoryList = ({ params }: Props) => {
  const { data, isLoading, isError } = useCategoryChildren(params)

  if (isLoading) return <CategorySkeleton />
  if (isError) return <CategoryError />
  if (!data?.length) return <CategoryEmpty />

  return (
    <div>
      {data.map(category => (
        <CategoryItem key={category.id} category={category} />
      ))}
    </div>
  )
}
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ UI –ª–æ–≥–∏–∫–∏:**

```typescript
// ‚ùå –ù–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫
export const useCategoryChildren = (params?: CategoryChildrenParams) => {
  const { data, isLoading, isError } = useQuery({
    ...categoryApi.getCategoryChildrenQueryOptions(params),
  })

  // ‚ùå UI –ª–æ–≥–∏–∫–∞ –≤ —Ö—É–∫–µ
  if (isLoading) return <CategorySkeleton />
  if (isError) return <CategoryError />
  if (!data?.length) return <CategoryEmpty />

  return data
}
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Query —Ö—É–∫–∞

```typescript
// use-{feature}-data.ts
'use client'

import { useQuery } from '@tanstack/react-query'
import { {entityName}Api, type {EntityName}Params } from '@/entities/{entity-name}'

/**
 * –•—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö {feature}
 *
 * @param params - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
 * @returns –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å –¥–∞–Ω–Ω—ã–º–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–∫–∏
 */
export const use{Feature}Data = (params?: {EntityName}Params) => {
  return useQuery({
    ...{entityName}Api.get{EntityName}sQueryOptions(params),
  })
}
```

### 2. Mutation —Ö—É–∫–∏ (–¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è mutation —Ö—É–∫–æ–≤

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - —Ö—É–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –∏ –∫–æ–ª–ª–±—ç–∫–∞–º–∏:**

```typescript
// use-create-category.ts
'use client'

import { useRouter } from 'next/navigation'
import { useMutation, useQueryClient } from '@tanstack/react-query'
import { toast } from 'sonner'
import { categoryApi, categoryKeys } from '@/entities/category'
import { logError } from '@/shared/utils'

// use-create-category.ts

// use-create-category.ts

// use-create-category.ts

// use-create-category.ts

interface UseCreateCategoryOptions {
  onSuccess?: (data: Category) => void
  onError?: (error: Error, variables: CreateCategoryDto) => void
  onSettled?: () => void
}

/**
 * –•—É–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
 *
 * @param options - –û–ø—Ü–∏–∏ –∫–æ–ª–ª–±—ç–∫–æ–≤ –¥–ª—è –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –º—É—Ç–∞—Ü–∏–∏
 * @returns –û–±—ä–µ–∫—Ç –º—É—Ç–∞—Ü–∏–∏ —Å –º–µ—Ç–æ–¥–∞–º–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
 */
export const useCreateCategory = (options: UseCreateCategoryOptions = {}) => {
  const router = useRouter()
  const queryClient = useQueryClient()

  return useMutation({
    mutationFn: categoryApi.create,

    // –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
    retry: 2,
    retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 10000),

    onSuccess: (data, variables, context) => {
      // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
      toast.success('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞')

      // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      queryClient.invalidateQueries({ queryKey: categoryKeys.all() })

      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ —É—Å–ø–µ—Ö–∞
      options.onSuccess?.(data)
    },

    onError: (error, variables, context) => {
      // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
      logError('‚ùå [useCreateCategory] –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è:', error)

      // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
      toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.')

      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ –æ—à–∏–±–∫–∏
      options.onError?.(error, variables)
    },

    onSettled: () => {
      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
      options.onSettled?.()
    },
  })
}
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Mutation —Ö—É–∫–∞

```typescript
// use-create-{feature}.ts
'use client'

import { useMutation, useQueryClient } from '@tanstack/react-query'
import { useRouter } from 'next/navigation'
import { toast } from 'sonner'
import { {entityName}Api, {entityName}Keys } from '@/entities/{entity-name}'
import { logError } from '@/shared/utils'

interface UseCreate{Feature}Options {
  onSuccess?: (data: {EntityName}) => void
  onError?: (error: Error, variables: Create{EntityName}Dto) => void
  onSettled?: () => void
}

/**
 * –•—É–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ {feature}
 *
 * @param options - –û–ø—Ü–∏–∏ –∫–æ–ª–ª–±—ç–∫–æ–≤ –¥–ª—è –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –º—É—Ç–∞—Ü–∏–∏
 * @returns –û–±—ä–µ–∫—Ç –º—É—Ç–∞—Ü–∏–∏ —Å –º–µ—Ç–æ–¥–∞–º–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
 */
export const useCreate{Feature} = (options: UseCreate{Feature}Options = {}) => {
  const router = useRouter()
  const queryClient = useQueryClient()

  return useMutation({
    mutationFn: {entityName}Api.create,

    // –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
    retry: 2,
    retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 10000),

    onSuccess: (data, variables, context) => {
      // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
      toast.success('{Feature} —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω')

      // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      queryClient.invalidateQueries({ queryKey: {entityName}Keys.all() })

      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ —É—Å–ø–µ—Ö–∞
      options.onSuccess?.(data)
    },

    onError: (error, variables, context) => {
      // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
      logError('‚ùå [useCreate{Feature}] –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è:', error)

      // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
      toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å {feature}. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.')

      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ –æ—à–∏–±–∫–∏
      options.onError?.(error, variables)
    },

    onSettled: () => {
      // –í—ã–∑–æ–≤ –∫–æ–ª–ª–±—ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
      options.onSettled?.()
    },
  })
}
```

### 3. Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

- **–£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `toast.success()` —Å –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- **–û—à–∏–±–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `toast.error()` —Å –ø–æ–ª–µ–∑–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `toast.warning()` –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- **–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ**

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
onSuccess: (data) => {
  toast.success('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω')
  // ... –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞
},

onError: (error) => {
  toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.')
  // ... –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞
},

onSettled: () => {
  toast.warning('–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏')
  // ... –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞
}
```

### 4. –ö–æ–ª–ª–±—ç–∫–∏

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∫–æ–ª–ª–±—ç–∫–æ–≤

- **onSuccess**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –º—É—Ç–∞—Ü–∏–∏, –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- **onError**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ –º—É—Ç–∞—Ü–∏–∏, –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- **onSettled**: –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–∏ (—É—Å–ø–µ—Ö –∏–ª–∏ –æ—à–∏–±–∫–∞)
- **–í—Å–µ –∫–æ–ª–ª–±—ç–∫–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã**

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–ª–ª–±—ç–∫–æ–≤
const createUserMutation = useCreateUser({
  onSuccess: user => {
    console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω:', user)
    router.push(`/users/${user.id}`)
  },
  onError: (error, userData) => {
    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
    // –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  },
  onSettled: () => {
    console.log('–û–ø–µ—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞')
    // –õ–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏
  },
})
```

### 5. –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã –ª–æ–≥–∏–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

- **Query —Ö—É–∫–∏**: –û–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ retry (TanStack Query –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ)
- **Mutation —Ö—É–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ retry –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫, –Ω–µ –¥–ª—è –æ—à–∏–±–æ–∫ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- **–ó–∞–¥–µ—Ä–∂–∫–∞ retry**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
return useMutation({
  mutationFn: api.create,

  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è retry
  retry: 2, // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–æ 2 —Ä–∞–∑
  retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 10000), // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

  onError: (error) => {
    // –ü–æ–≤—Ç–æ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö, –Ω–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
    if (error.status === 500) {
      // –ë—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å
    } else if (error.status === 400) {
      // –ù–µ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å - –æ—à–∏–±–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
    }
  },
})
```

### 6. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏ UI**: –û–±–Ω–æ–≤–ª—è–π—Ç–µ UI –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ, –æ—Ç–∫–∞—Ç—ã–≤–∞–π—Ç–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–∫–∞—Ç–∞**: –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ—Ç–∫–∞—Ç–∞
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–µ—Ç—Å—è

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
return useMutation({
  mutationFn: api.update,

  onMutate: async (newData) => {
    // –û—Ç–º–µ–Ω–∏—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
    await queryClient.cancelQueries({ queryKey: {entityName}Keys.detail(newData.id) })

    // –°–Ω–∏–º–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    const previousData = queryClient.getQueryData({entityName}Keys.detail(newData.id))

    // –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
    queryClient.setQueryData({entityName}Keys.detail(newData.id), newData)

    // –í–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–∫–∞—Ç–∞
    return { previousData }
  },

  onError: (error, newData, context) => {
    // –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
    if (context?.previousData) {
      queryClient.setQueryData({entityName}Keys.detail(newData.id), context.previousData)
    }
  },

  onSettled: (data, error, newData) => {
    // –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ —É—Å–ø–µ—Ö–∞
    queryClient.invalidateQueries({ queryKey: {entityName}Keys.detail(newData.id) })
  },
})
```

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è Mutation —Ö—É–∫–æ–≤

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:

- [ ] **JSDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ç–∏–ø–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [ ] **Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —É—Å–ø–µ—Ö–∞ –∏ –æ—à–∏–±–∫–∏
- [ ] **–û–ø—Ü–∏–∏ –∫–æ–ª–ª–±—ç–∫–æ–≤** (onSuccess, onError, onSettled)
- [ ] **–õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫** —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- [ ] **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** —Å –ø–æ–º–æ—â—å—é logError helper
- [ ] **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:

- [ ] **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** –¥–ª—è –ª—É—á—à–µ–≥–æ UX
- [ ] **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∑–∞–≥—Ä—É–∑–∫–∏**
- [ ] **–ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- [ ] **–ù–∞–≤–∏–≥–∞—Ü–∏—è** –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –î–µ—Ä–∂–∏—Ç–µ –ª–æ–≥–∏–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ö—É–∫–∞—Ö, UI –ª–æ–≥–∏–∫—É –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ö—É–∫–∏ –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Ö—É–∫–∏ —Å JSDoc
6. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ö—É–∫–æ–≤
7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏
8. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–æ—Å—Ç—É–ø–Ω—ã
9. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –°–ª–µ–¥—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –≤–æ –≤—Å–µ—Ö —Ö—É–∫–∞—Ö
10. **–ö–æ–ª–ª–±—ç–∫–∏**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–ª–ª–±—ç–∫–æ–≤ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å—É—â–Ω–æ—Å—Ç–µ–π](./entity-structure-guide.md)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](./project-structure.md)
- [–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞](../code-standards.md)
